<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enterprise Persona Platform</title>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- CSS Files -->
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/pages.css">
  <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
  <!-- í—¤ë” -->
  <header class="header">
    <div class="header-content">
      <div class="logo">Enterprise Persona Platform</div>
      
      <!-- ëª¨ë“œ ì„ íƒ ë©”ë‰´ (ëŒ€ì‹œë³´ë“œì—ì„œë§Œ í‘œì‹œ) -->
      <div class="header-mode-selector" id="header-mode-selector">
        <button class="mode-nav-item active" data-mode="tool">
          <span class="mode-nav-icon">ğŸ”§</span>
          <span>ì‘ì—… ë„êµ¬</span>
        </button>
        <button class="mode-nav-item" data-mode="guide">
          <span class="mode-nav-icon">ğŸ“š</span>
          <span>ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ</span>
        </button>
        <button class="mode-nav-item" data-mode="hybrid">
          <span class="mode-nav-icon">âš¡</span>
          <span>í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ</span>
        </button>
      </div>
      
      <nav class="header-nav">
        <button class="nav-item active" data-page="dashboard">ë©”ì¸ ëŒ€ì‹œë³´ë“œ</button>
        <button class="nav-item" data-page="projects">í”„ë¡œì íŠ¸ ê´€ë¦¬</button>
        <button class="nav-item" data-page="settings">ì„¤ì •</button>
      </nav>
    </div>
  </header>

  <div class="main-container">
    <!-- ë©”ì¸ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ -->
    <div id="dashboard-page" class="page-content active">
      <!-- ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ ëª¨ë“œ -->
      <div id="workflow-guide-mode" class="workflow-guide-mode">
        <div id="guide-content"></div>
      </div>

      <!-- ì‘ì—… ë„êµ¬ ëª¨ë“œ -->
      <div id="tool-mode" class="tool-mode active">
        <div class="tool-sidebar">
          <div id="sidebar-content"></div>
        </div>
        <div class="tool-content">
          <div id="current-section-content"></div>
        </div>
      </div>

      <!-- í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ -->
      <div id="hybrid-mode" class="hybrid-mode">
        <div class="hybrid-panel">
          <div class="hybrid-header">ğŸ“š ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ</div>
          <div class="hybrid-content" id="hybrid-guide-content"></div>
        </div>
        <div class="hybrid-panel">
          <div class="hybrid-header">ğŸ”§ ì‘ì—… ë„êµ¬</div>
          <div class="hybrid-content" id="hybrid-tool-content"></div>
        </div>
      </div>
    </div>

    <!-- í”„ë¡œì íŠ¸ ê´€ë¦¬ í˜ì´ì§€ -->
    <div id="projects-page" class="page-content">
      <div id="projects-content"></div>
    </div>

    <!-- ì„¤ì • í˜ì´ì§€ -->
    <div id="settings-page" class="page-content">
      <div id="settings-content"></div>
    </div>
  </div>

  <!-- ì—°ê²° ìƒíƒœ í‘œì‹œ -->
  <div class="connection-status status-success">
    ğŸ”— ì‹œìŠ¤í…œ ì—°ê²°ë¨
  </div>

  <!-- ğŸ”§ ì„ì‹œ Fallback ìƒìˆ˜ ì •ì˜ (ëˆ„ë½ëœ íŒŒì¼ ëŒ€ë¹„) -->
  <script>
    // ê¸°ë³¸ ìƒìˆ˜ ì •ì˜ (config.jsê°€ ì—†ì„ ê²½ìš° ëŒ€ë¹„)
    window.MODES = window.MODES || {
      GUIDE: 'guide',
      TOOL: 'tool', 
      HYBRID: 'hybrid'
    };

    window.PAGES = window.PAGES || {
      DASHBOARD: 'dashboard',
      PROJECTS: 'projects',
      SETTINGS: 'settings'
    };

    window.SECTIONS = window.SECTIONS || [
      'business-context',
      'data-integration', 
      'persona-modeling',
      'market-intelligence',
      'strategy-simulation',
      'insights-dashboard',
      'performance-tracking'
    ];

    window.SECTION_META = window.SECTION_META || {
      'business-context': { title: 'ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸', icon: 'ğŸ¯' },
      'data-integration': { title: 'ë°ì´í„° í†µí•©', icon: 'ğŸ”—' },
      'persona-modeling': { title: 'í˜ë¥´ì†Œë‚˜ ëª¨ë¸ë§', icon: 'ğŸ‘¥' },
      'market-intelligence': { title: 'ì‹œì¥ ì¸í…”ë¦¬ì „ìŠ¤', icon: 'ğŸ“Š' },
      'strategy-simulation': { title: 'ì „ëµ ì‹œë®¬ë ˆì´ì…˜', icon: 'ğŸ®' },
      'insights-dashboard': { title: 'ì¸ì‚¬ì´íŠ¸ ëŒ€ì‹œë³´ë“œ', icon: 'ğŸ’¡' },
      'performance-tracking': { title: 'ì„±ê³¼ ì¶”ì ', icon: 'ğŸ“ˆ' }
    };

    // ê¸°ë³¸ ì•± ìƒíƒœ (state.jsê°€ ì—†ì„ ê²½ìš° ëŒ€ë¹„)
    window.appState = window.appState || {
      state: {
        currentMode: 'tool',
        currentPage: 'dashboard', 
        currentSection: 'business-context'
      },
      getState: function(key) { return this.state[key]; },
      setMode: function(mode) { 
        this.state.currentMode = mode;
        console.log('ëª¨ë“œ ë³€ê²½:', mode);
      },
      setPage: function(page) {
        this.state.currentPage = page;
        console.log('í˜ì´ì§€ ë³€ê²½:', page);
      },
      setSection: function(section) {
        this.state.currentSection = section;
        console.log('ì„¹ì…˜ ë³€ê²½:', section);
        if (window.sectionManager) {
          window.sectionManager.updateSection(section);
        }
      },
      subscribe: function() {},
      autoSave: function() { console.log('ìë™ ì €ì¥ë¨'); }
    };

    // ê¸°ë³¸ APP_CONFIG
    window.APP_CONFIG = window.APP_CONFIG || {
      animation: {
        duration: { normal: 300 },
        easing: 'ease-in-out'
      }
    };

    // ê¸°ë³¸ BrowserUtils
    window.BrowserUtils = window.BrowserUtils || {
      supports: {
        localStorage: true,
        fetch: true
      },
      prefersReducedMotion: () => false
    };

    // ğŸš¨ ê°•ì œ SectionManager ìƒì„± (sections.js ì‹¤íŒ¨ ì‹œ ëŒ€ë¹„)
    window.createFallbackSectionManager = function() {
      console.log('ğŸš¨ Fallback SectionManager ìƒì„± ì¤‘...');
      
      window.sectionManager = {
        currentSection: 'business-context',
        
        createSidebarContent: function() {
          return `
            <div class="sidebar-section">
              <h3>ğŸ“Š ë¶„ì„ ë‹¨ê³„</h3>
              <div class="sidebar-item active" data-section="business-context">
                <span class="icon">ğŸ¯</span>
                <span class="text">ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸</span>
              </div>
              <div class="sidebar-item" data-section="data-integration">
                <span class="icon">ğŸ”—</span>
                <span class="text">ë°ì´í„° í†µí•©</span>
              </div>
              <div class="sidebar-item" data-section="persona-modeling">
                <span class="icon">ğŸ‘¥</span>
                <span class="text">í˜ë¥´ì†Œë‚˜ ëª¨ë¸ë§</span>
              </div>
              <div class="sidebar-item" data-section="market-intelligence">
                <span class="icon">ğŸ“Š</span>
                <span class="text">ì‹œì¥ ì¸í…”ë¦¬ì „ìŠ¤</span>
              </div>
            </div>
            
            <div class="sidebar-section">
              <h3>ğŸš€ ì „ëµ ìˆ˜ë¦½</h3>
              <div class="sidebar-item" data-section="strategy-simulation">
                <span class="icon">ğŸ®</span>
                <span class="text">ì „ëµ ì‹œë®¬ë ˆì´ì…˜</span>
              </div>
              <div class="sidebar-item" data-section="insights-dashboard">
                <span class="icon">ğŸ’¡</span>
                <span class="text">ì¸ì‚¬ì´íŠ¸ ëŒ€ì‹œë³´ë“œ</span>
              </div>
              <div class="sidebar-item" data-section="performance-tracking">
                <span class="icon">ğŸ“ˆ</span>
                <span class="text">ì„±ê³¼ ì¶”ì </span>
              </div>
            </div>

            <div class="progress-indicator">
              <div class="progress-bar">
                <div class="progress-fill" style="width: 45%"></div>
              </div>
              <div class="progress-text">
                <span>ì „ì²´ ì§„í–‰ë¥ </span>
                <span class="progress-percentage">45%</span>
              </div>
            </div>
          `;
        },
        
        createWorkflowGuideContent: function() {
          return `
            <div class="guide-hero">
              <h2>ğŸ“š ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ</h2>
              <p>ì²´ê³„ì ì¸ í˜ë¥´ì†Œë‚˜ ì „ëµ ìˆ˜ë¦½ì„ ìœ„í•œ ë‹¨ê³„ë³„ ê°€ì´ë“œ</p>
            </div>
            <div class="guide-steps">
              <div class="guide-step">
                <div class="step-icon">ğŸ¯</div>
                <h3>1. í”„ë¡œì íŠ¸ ì„¤ì •</h3>
                <ul>
                  <li>ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ ì„¤ì •</li>
                  <li>íƒ€ê²Ÿ ì‹œì¥ ì •ì˜</li>
                  <li>ë°ì´í„° ì†ŒìŠ¤ ì—°ê²°</li>
                </ul>
              </div>
            </div>
          `;
        },
        
        createSectionContent: function(sectionId) {
          return `
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">${SECTION_META[sectionId]?.title || sectionId}</h2>
                <p class="card-subtitle">ì´ ì„¹ì…˜ì˜ ì½˜í…ì¸ ì…ë‹ˆë‹¤.</p>
              </div>
              <div class="form-group">
                <p>í˜„ì¬ ì„¹ì…˜: <strong>${sectionId}</strong></p>
                <p>ì‚¬ì´ë“œë°”ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤! âœ…</p>
              </div>
            </div>
          `;
        },
        
        createHybridToolContent: function(sectionId) {
          return `<p>í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ: ${sectionId}</p>`;
        },
        
        updateSection: function(sectionId) {
          console.log('ğŸ“ sectionManager.updateSection í˜¸ì¶œ:', sectionId);
          this.currentSection = sectionId;
          
          // ë©”ì¸ ì½˜í…ì¸  ì—…ë°ì´íŠ¸
          const mainContent = document.getElementById('current-section-content');
          if (mainContent) {
            mainContent.innerHTML = this.createSectionContent(sectionId);
          }
          
          // í•˜ì´ë¸Œë¦¬ë“œ ì½˜í…ì¸  ì—…ë°ì´íŠ¸
          const hybridContent = document.getElementById('hybrid-tool-content');
          if (hybridContent) {
            hybridContent.innerHTML = this.createHybridToolContent(sectionId);
          }
          
          // ì‚¬ì´ë“œë°” í™œì„±í™”
          const allItems = document.querySelectorAll('.sidebar-item');
          allItems.forEach(item => item.classList.remove('active'));
          
          const activeItem = document.querySelector(`[data-section="${sectionId}"]`);
          if (activeItem) {
            activeItem.classList.add('active');
          }
          
          console.log('âœ… ì„¹ì…˜ ì—…ë°ì´íŠ¸ ì™„ë£Œ:', sectionId);
        }
      };
      
      console.log('âœ… Fallback SectionManager ìƒì„± ì™„ë£Œ');
    };
  </script>

  <!-- ğŸ”§ JavaScript Files - ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ë¡œë“œ -->
  <!-- 1. ìœ í‹¸ë¦¬í‹°ì™€ ê¸°ë³¸ í•¨ìˆ˜ë“¤ ë¨¼ì € -->
  <script src="js/utils.js"></script>
  
  <!-- 2. ì„¤ì • íŒŒì¼ë“¤ (ì„ íƒì ) -->
  <script src="js/config.js" onerror="console.warn('config.js íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.')"></script>
  <script src="js/state.js" onerror="console.warn('state.js íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.')"></script>
  
  <!-- 3. ì„¹ì…˜ ê´€ë¦¬ì -->
  <script src="js/sections.js"></script>
  
  <!-- 4. ê¸°íƒ€ ëª¨ë“ˆë“¤ (ì„ íƒì ) -->
  <script src="js/pages.js" onerror="console.warn('pages.js íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')"></script>
  <script src="js/modes.js" onerror="console.warn('modes.js íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')"></script>
  <script src="js/events.js" onerror="console.warn('events.js íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')"></script>
  
  <!-- 5. ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§ˆì§€ë§‰ -->
  <script src="js/app.js"></script>

  <!-- ğŸš¨ ê¸´ê¸‰ ë””ë²„ê¹… ë° ê°•ì œ ì´ë²¤íŠ¸ ì„¤ì • -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ” DOM ë¡œë“œ ì™„ë£Œ - ë””ë²„ê¹… ì‹œì‘');
      
      // í•„ìˆ˜ ê°ì²´ë“¤ í™•ì¸
      setTimeout(() => {
        console.log('âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸:');
        console.log('- DOM ê°ì²´:', typeof DOM, !!DOM?.$);
        console.log('- appState:', typeof appState, !!appState?.setSection);
        console.log('- sectionManager:', typeof sectionManager);
        
        // ğŸš¨ sectionManagerê°€ ì—†ìœ¼ë©´ ê°•ì œ ìƒì„±
        if (!window.sectionManager) {
          console.warn('ğŸš¨ sectionManagerê°€ ì—†ìŒ! Fallback ìƒì„±...');
          if (window.createFallbackSectionManager) {
            window.createFallbackSectionManager();
          }
        }
        
        // ì‚¬ì´ë“œë°” ê°•ì œ ì´ë²¤íŠ¸ ì„¤ì • (fallback)
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        console.log('- ì‚¬ì´ë“œë°” í•­ëª© ìˆ˜:', sidebarItems.length);
        
        if (sidebarItems.length === 0) {
          console.warn('âš ï¸ ì‚¬ì´ë“œë°” í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ê°•ì œ ìƒì„±...');
          
          // ê°•ì œë¡œ ì‚¬ì´ë“œë°” ìƒì„±
          const sidebarContent = document.getElementById('sidebar-content');
          if (sidebarContent && window.sectionManager) {
            sidebarContent.innerHTML = sectionManager.createSidebarContent();
            console.log('ğŸ”§ ì‚¬ì´ë“œë°” ê°•ì œ ìƒì„±ë¨');
            
            // ìƒì„±ëœ í•­ëª©ì— ì´ë²¤íŠ¸ ì¶”ê°€
            setTimeout(() => {
              const newItems = document.querySelectorAll('.sidebar-item');
              console.log('ğŸ”„ ìƒˆë¡œ ìƒì„±ëœ ì‚¬ì´ë“œë°” í•­ëª©:', newItems.length);
            }, 100);
          }
        }
        
        // ê°•ì œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ì•ˆì „ë§)
        document.addEventListener('click', (e) => {
          const sidebarItem = e.target.closest('.sidebar-item');
          if (sidebarItem?.dataset?.section) {
            console.log('ğŸ¯ ì‚¬ì´ë“œë°” í´ë¦­ ê°ì§€:', sidebarItem.dataset.section);
            
            // ê¸°ì¡´ active ì œê±°
            document.querySelectorAll('.sidebar-item').forEach(item => {
              item.classList.remove('active');
            });
            
            // í´ë¦­ëœ í•­ëª© í™œì„±í™”
            sidebarItem.classList.add('active');
            
            // ìƒíƒœ ì—…ë°ì´íŠ¸
            if (window.appState?.setSection) {
              window.appState.setSection(sidebarItem.dataset.section);
            }
          }
        });
        
        // ğŸ”§ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°•ì œ ì¬ì‹œì‘ (í•„ìš”ì‹œ)
        if (window.app && !window.app.isInitialized) {
          console.log('ğŸ”„ ì•± ì¬ì´ˆê¸°í™” ì‹œë„...');
          window.app.init().catch(console.error);
        }
        
        // ğŸš¨ sections.js ì˜¤ë¥˜ ë°©ì§€ë¥¼ ìœ„í•œ ê°•ì œ ì˜¤ë²„ë¼ì´ë“œ
        if (window.sectionManager && window.sectionManager.updateSection) {
          console.log('ğŸ”§ sectionManager.updateSection ì˜¤ë²„ë¼ì´ë“œ...');
          
          const originalUpdateSection = window.sectionManager.updateSection;
          window.sectionManager.updateSection = function(sectionId) {
            console.log('ğŸ›¡ï¸ ì•ˆì „í•œ updateSection í˜¸ì¶œ:', sectionId);
            
            try {
              // ê¸°ë³¸ ì½˜í…ì¸  ì—…ë°ì´íŠ¸
              const mainContent = document.getElementById('current-section-content');
              if (mainContent) {
                mainContent.innerHTML = this.createSectionContent ? 
                  this.createSectionContent(sectionId) : 
                  `<div class="card"><h2>${sectionId} ì„¹ì…˜</h2><p>ì½˜í…ì¸ ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p></div>`;
              }
              
              // ì‚¬ì´ë“œë°” ì—…ë°ì´íŠ¸ (100% ì•ˆì „)
              const allItems = document.querySelectorAll('.sidebar-item');
              if (allItems.length > 0) {
                allItems.forEach(item => {
                  if (item && item.classList) {
                    item.classList.remove('active');
                  }
                });
                
                const activeItem = document.querySelector(`[data-section="${sectionId}"]`);
                if (activeItem && activeItem.classList) {
                  activeItem.classList.add('active');
                }
              }
              
              this.currentSection = sectionId;
              console.log('âœ… ì•ˆì „í•œ updateSection ì™„ë£Œ:', sectionId);
              
            } catch (error) {
              console.error('updateSection ì˜¤ë²„ë¼ì´ë“œ ì˜¤ë¥˜:', error);
              // fallbackìœ¼ë¡œ ì›ë³¸ í˜¸ì¶œ ì‹œë„
              try {
                originalUpdateSection.call(this, sectionId);
              } catch (originalError) {
                console.error('ì›ë³¸ updateSectionë„ ì‹¤íŒ¨:', originalError);
              }
            }
          };
          
          console.log('âœ… updateSection ì˜¤ë²„ë¼ì´ë“œ ì™„ë£Œ');
        }
        
      }, 1000);
    });
  </script>
</body>
</html>